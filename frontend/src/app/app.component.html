<!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * -->
<!-- * * * * * * * * * * * The content below * * * * * * * * * * * -->
<!-- * * * * * * * * * * is only a placeholder * * * * * * * * * * -->
<!-- * * * * * * * * * * and can be replaced.  * * * * * * * * * * -->
<!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * -->
<!-- * * * * * * * * * Delete the template below * * * * * * * * * -->
<!-- * * * * * * * to get started with your project! * * * * * * * -->
<!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * -->
<!--
  Gokul - 15th and 16th Apr 2025, UI to capture custom skills, Job post and resume upload
  to compare the skills and produce match score.
  Gokul, 20-Apr-2025, 21-Apr-2025, added Resume feedback, loading message, Move CSS to separate file
  Gokul, 22-Apr to 23-Apr - File upload restriction, SSL enaled, RWD enabled, Improvised parsing
    Identified a major issue in skills capture utilization & fixed
-->
<link rel="stylesheet" href="app.component.css">

<div>
  <h3 style="text-align: center;background-color: orange"><font color="DarkBlue">{{ title }}</font></h3>
  <p style="font-size: medium">
    <font color="darkblue">
      <strong>Overview : </strong>
      This application evaluates how well your skills align with a specific job description by calculating a relevance score. It uses advanced <b>Natural Language Processing (NLP)</b> and <b>Optical Character Recognition (OCR)</b> techniques to extract information from resumes in various formats.
      Additionally, it scans your resume and provides <b>detailed feedback</b> on the length of your profile relative to your experience, as well as your use of action verbs and key nouns.
      The tool provides real-time job matching with fuzzy skill matching, helping you fine-tune your resume for better alignment with job requirements, all while ensuring a seamless user experience across devices with responsive web design (<b>RWD</b>).
      <br /><br />
    </font><font color="red">
      ‚ö†Ô∏è <b>Note: OCR is only applied to images and works best with high-quality, clear images (Good DPI).</b>
    </font><br />
    <font color="darkblue">
      üîí <b>Security:</b> Basic security measures are in place, including SSL, file size restrictions (max 2MB), Rate limit to API and UUID-based file paths to enhance privacy and security.
    </font><br />
    <font color="darkblue">
      <strong>üìã Instructions : </strong>
      Upload your resume, add custom skills or job description, and click <b>Analyze Resume</b>".
    </font>
  </p>
</div>
<hr />
<main class="main">
  <div class="content">
    <div class="left-side">

      <button (click)="analyzeResume()" class="pill" style="font-size: large; background-color: orange"><font color="DarkBlue">Analyze Resume</font></button>

      <p class="pill"><strong><font color="red">*</font> Upload File (</strong> <font size="2">Supported Formats - txt, docx, pdf, jpg, png ); max 2MB size</font></p>
      <input class="left-side" type="file" (change)="onFileSelected($event)" required />
      <br />

      <p class="pill">
        <strong>Years of Experience </strong>&nbsp;&nbsp;&nbsp;
        <input [(ngModel)]="experienceYears" type="number" min="1" max="75"
               (input)="onExperienceInput($event)"
               style="width: 50px;" required />
      </p>

      <p class="pill"><strong>Job Description </strong> </p>
      <textarea [(ngModel)]="jobDescription" placeholder="Looking for a candidate with skills in Python, Machine Learning, AI, NLP and project management."
                rows="3" cols="50" maxlength="1000"></textarea>
      <p [ngStyle]="{color: (1000 - (jobDescription.length || 0)) < 50 ? 'red' : 'gray',
      'font-size': 'small', 'margin-top': '1px', 'margin-bottom': '0'}">
        {{ 1000 - (jobDescription.length || 0) }} characters left
      </p>

      <p>
        <font style="font-size: small; background-color: green;" color="white">
          You may also add key Technical and Soft Skills for more accurate matching
          if not mentioned in the job description.
        </font>
      </p>

      <p class="pill"><strong>Technical Skills </strong> </p>
      <textarea [(ngModel)]="skillsList" placeholder="Python, Machine Learning, Artificial Intelligence, Angular, AWS, Git, NLP"
                rows="3" cols="50" maxlength="1000">
       </textarea>
      <p [ngStyle]="{color: (1000 - (skillsList.length || 0)) < 50 ? 'red' : 'gray',
      'font-size': 'small', 'margin-top': '1px', 'margin-bottom': '0'}">
        {{ 1000 - (skillsList.length || 0) }} characters left
      </p>

      <p class="pill"><strong>Soft Skills </strong> </p>
      <textarea [(ngModel)]="softSkills" placeholder="Teamwork, Communication, Leadership"
                rows="2" cols="50" maxlength="1000">
       </textarea>
      <p [ngStyle]="{color: (1000 - (softSkills.length || 0)) < 50 ? 'red' : 'gray',
      'font-size': 'small', 'margin-top': '1px', 'margin-bottom': '0'}">
        {{ 1000 - (softSkills.length || 0) }} characters left
      </p><br />

      <button (click)="analyzeResume()" class="pill" style="font-size: large; background-color: orange"><font color="DarkBlue">Analyze Resume</font></button>

    </div>

    <div class="divider" role="separator" aria-label="Divider"></div>

  </div>

  <div *ngIf="result; else noResult" class="right-side" style="width: 400px;">
    <h3 class="pill" style="font-size: large; background-color: orange">
      <strong><font color="DarkBlue">Analysis Result</font></strong>
    </h3>

    <!-- ‚úÖ Image quality section -->
    <div *ngIf="result.image_quality">
      <p [ngClass]="{
      'text-success': result.image_quality === 'good',
      'text-danger': result.image_quality === 'poor'
    }" style="color: darkred;">
        <strong>Image Quality: </strong> {{ result.image_quality | titlecase }}
      </p>

      <p *ngIf="result.ocr_confidence !== undefined" style="color: darkred;">
        <strong>OCR Confidence: </strong>{{ result.ocr_confidence }}%
      </p>

      <p *ngIf="result.ocr_message" class="text-warning" style="color: darkred;">
        {{ result.ocr_message }}
      </p>

      <br />
    </div>

    <!-- ‚úÖ Only show analysis if quality is not 'poor' -->
    <div *ngIf="result.image_quality !== 'poor'">
      <p style="color: darkred;"><strong>Emails:</strong> {{ result.emails?.join(', ') }}</p>
      <p style="color: darkred;"><strong>Phone Numbers:</strong> {{ result.phone_numbers?.join(', ') }}</p>
      <p style="color: darkred;"><strong>Technical :</strong> {{ result.tech_skills?.join(', ') }}</p>
      <p style="color: darkred;"><strong>Soft :</strong> {{ result.soft_skills?.join(', ') }}</p><br />
      <p [ngStyle]="{'background-color' : result.match_score >= 60 ? 'lightgreen' : 'red',
        'color': result.match_score >= 60 ? 'darkred' : 'white',
        'padding': '8px',
        'border-radius': '5px'
        }">
        <strong>Match Score: {{ result.match_score }} </strong>
      </p>
      <p style="color: darkred;"><strong>Matched Skills:</strong> {{ result.matched_skills?.join(', ') }}</p>
      <p style="color: darkred;"><strong>Missing Skills:</strong> {{ result.missing_skills?.join(', ') }}</p>
      <!--<p style="color: darkred;">
        <strong>Total Required Skills:</strong> {{ result.total_required }} |
        <strong>Total Matched Skills:</strong> {{ result.total_matched }}
      </p>-->
    </div>

    <div *ngIf="result.image_quality === 'poor'" style="margin-top: 10px;">
      <p style="color: darkred;"><strong>Resume analysis skipped due to poor image quality.</strong></p>
    </div>

    <div *ngIf="result.feedback?.length  && result.image_quality !== 'poor'">

      <br /><p style="color: darkblue; background-color: bisque"><strong>üìù Resume Feedback</strong></p>
      <ul>
        <li *ngFor="let fb of result.feedback" style="color: darkblue">{{ fb }}</li>
      </ul>
    </div>

  </div>

  <ng-template #noResult>
    <div *ngIf="isLoading" style="text-align: center; margin-top: 20px;" class="result-panel">
      <p style="color: darkblue;"><strong>‚è≥ Analyzing your resume, please wait...</strong></p>
    </div>
    <div *ngIf="!isLoading" style="color: gray; font-style: italic;" class="result-panel">
      No results to display yet. Please upload your resume and click Analyze.
    </div>
  </ng-template>
</main>

  <p><b>
  <font color="red">üîí Privacy Note:</font>
  <font color="darkblue">
  Your resume is never stored. All processing is done in-memory, and any temporary data
  used during analysis is automatically </font>
  <font color="red">deleted immediately </font>
  <font color="darkblue"> after processing is complete. </font>
  </b></p>
